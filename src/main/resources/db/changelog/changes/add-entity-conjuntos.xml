<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">


    <changeSet id="1" author="ccamilo">
        <sql>
            CREATE TABLE "conjunto" (
            "id" serial PRIMARY KEY,
            "nombre" varchar,
            "ubicacion" varchar,
            "direccion" varchar,
            "id_estado_conjunto" integer,
            "fecha_creacion" timestamp
            );

            CREATE TABLE "estado_conjunto" (
            "id" serial PRIMARY KEY,
            "estado" varchar,
            "fecha_creacion" timestamp
            );

            CREATE TABLE "aviso" (
            "id" serial PRIMARY KEY,
            "titulo" varchar,
            "contenido" varchar,
            "fecha_creacion" timestamp
            );

            CREATE TABLE "notificacion" (
            "id" serial PRIMARY KEY,
            "id_unidad" integer,
            "id_aviso" integer,
            "fecha_creacion" timestamp
            );

            CREATE TABLE "residente" (
            "id" serial PRIMARY KEY,
            "nombre" varchar,
            "email" varchar,
            "telefono" varchar,
            "id_tipo" integer,
            "id_conjunto" integer,
            "id_estado" integer,
            "fecha_creacion" timestamp
            );

            CREATE TABLE "tipo_residente" (
            "id" serial PRIMARY KEY,
            "tipo" varchar,
            "fecha_creacion" timestamp
            );

            CREATE TABLE "estado_residente" (
            "id" serial PRIMARY KEY,
            "estado" varchar,
            "fecha_creacion" timestamp
            );

            CREATE TABLE "solicitud" (
            "id" serial PRIMARY KEY,
            "id_residente" integer,
            "id_estado" integer,
            "descripcion" varchar,
            "comentario" varchar,
            "fecha_creacion" timestamp
            );

            CREATE TABLE "estado_solicitud" (
            "id" serial PRIMARY KEY,
            "estado" varchar,
            "fecha_creacion" timestamp
            );

            CREATE TABLE "unidad" (
            "id" serial PRIMARY KEY,
            "interior" integer,
            "apto" integer,
            "id_conjunto" integer,
            "fecha_creacion" timestamp
            );

            CREATE TABLE "residente_unidad" (
            "id" serial PRIMARY KEY,
            "id_residente" integer,
            "id_unidad" integer,
            "id_estado" integer,
            "fecha_creacion" timestamp
            );

            CREATE TABLE "estado_residente_unidad" (
            "id" serial PRIMARY KEY,
            "estado" varchar,
            "fecha_creacion" timestamp
            );

            CREATE TABLE "factura_unidad" (
            "id" serial PRIMARY KEY,
            "id_unidad" integer,
            "id_estado" integer,
            "fecha_inicio" timestamp,
            "fecha_fin" timestamp,
            "total" integer,
            "fecha_creacion" timestamp
            );

            CREATE TABLE "estado_factura_unidad" (
            "id" serial PRIMARY KEY,
            "estado" varchar,
            "fecha_creacion" timestamp
            );

            CREATE TABLE "concepto_factura" (
            "id" serial PRIMARY KEY,
            "id_factura" integer,
            "id_concepto" integer,
            "valor" decimal,
            "fecha_creacion" timestamp
            );

            CREATE TABLE "concepto" (
            "id" serial PRIMARY KEY,
            "nombre" varchar,
            "valor" decimal,
            "fecha_creacion" timestamp
            );

            CREATE TABLE "unidad_concepto" (
            "id" serial PRIMARY KEY,
            "id_unidad" integer,
            "id_concepto" integer,
            "fecha_creacion" timestamp
            );

            CREATE TABLE "pago" (
            "id" serial PRIMARY KEY,
            "id_factura_unidad" integer,
            "valor" decimal,
            "metodo_pago" varchar,
            "fecha_creacion" timestamp
            );

            ALTER TABLE "conjunto" ADD FOREIGN KEY ("id_estado_conjunto") REFERENCES "estado_conjunto" ("id");

            ALTER TABLE "notificacion" ADD FOREIGN KEY ("id_aviso") REFERENCES "aviso" ("id");

            ALTER TABLE "notificacion" ADD FOREIGN KEY ("id_unidad") REFERENCES "unidad" ("id");

            ALTER TABLE "residente" ADD FOREIGN KEY ("id_tipo") REFERENCES "tipo_residente" ("id");

            ALTER TABLE "residente" ADD FOREIGN KEY ("id_conjunto") REFERENCES "conjunto" ("id");

            ALTER TABLE "residente" ADD FOREIGN KEY ("id_estado") REFERENCES "estado_residente" ("id");

            ALTER TABLE "solicitud" ADD FOREIGN KEY ("id_residente") REFERENCES "residente" ("id");

            ALTER TABLE "solicitud" ADD FOREIGN KEY ("id_estado") REFERENCES "estado_solicitud" ("id");

            ALTER TABLE "unidad" ADD FOREIGN KEY ("id_conjunto") REFERENCES "conjunto" ("id");

            ALTER TABLE "residente_unidad" ADD FOREIGN KEY ("id_residente") REFERENCES "residente" ("id");

            ALTER TABLE "residente_unidad" ADD FOREIGN KEY ("id_unidad") REFERENCES "unidad" ("id");

            ALTER TABLE "residente_unidad" ADD FOREIGN KEY ("id_estado") REFERENCES "estado_residente_unidad" ("id");

            ALTER TABLE "factura_unidad" ADD FOREIGN KEY ("id_unidad") REFERENCES "unidad" ("id");

            ALTER TABLE "factura_unidad" ADD FOREIGN KEY ("id_estado") REFERENCES "estado_factura_unidad" ("id");

            ALTER TABLE "concepto_factura" ADD FOREIGN KEY ("id_factura") REFERENCES "factura_unidad" ("id");

            ALTER TABLE "concepto_factura" ADD FOREIGN KEY ("id_concepto") REFERENCES "concepto" ("id");

            ALTER TABLE "unidad_concepto" ADD FOREIGN KEY ("id_unidad") REFERENCES "unidad" ("id");

            ALTER TABLE "unidad_concepto" ADD FOREIGN KEY ("id_concepto") REFERENCES "concepto" ("id");

            ALTER TABLE "pago" ADD FOREIGN KEY ("id_factura_unidad") REFERENCES "factura_unidad" ("id");

        </sql>
    </changeSet>

</databaseChangeLog>